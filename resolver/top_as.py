
# TopAS: list of top Ases thhat we are tracking. 
import sys
import rdap_names
import country
import pandas as pd

# List of ASes recognized as "top", taken from Alain's slide deck

TopAS = {
    "AS28573": ["Claro NXT Telecomunicacoes Ltda", "BR", "Cellular"],
    "AS26599": ["TELEFONICA BRASIL S.A", "BR", "Cellular"],
    "AS26615": ["TIM SA", "BR", "Cellular"],
    "AS7738": ["V tal", "BR", "Broadband"],
    "AS28126": ["BRISANET SERVICOS DE TELECOMUNICACOES S.A", "BR", "Broadband"],
    "AS268581": ["QNAX LTDA", "BR", "Broadband"],
    "AS7303": ["Telecom Argentina S.A.", "AR", "Broadband"],
    "AS19037": ["AMX Argentina S.A.", "AR", "Cellular"],
    "AS22927": ["Telefonica de Argentina", "AR", "Cellular"],
    "AS27747": ["Telecentro S.A.", "AR", "Broadband"],
    "AS11315": ["Telefonica Moviles Argentina S.A. Movistar Argentina", "AR", "Cellular"],
    "AS8151": ["UNINET", "MX", "Broadband"],
    "AS17072": ["TOTAL PLAY TELECOMUNICACIONES SA DE CV","MX", "Broadband"],
    "AS13999": ["Mega Cable S.A. de C.V.", "MX", "Broadband"],
    "AS28403": ["RadioMovil Dipsa S.A. de C.V.","MX", "Broadband"],
    "AS28548": ["Cablevision S.A. de C.V.", "MX", "Broadband"],
    "AS26611": ["COMUNICACION CELULAR S.A. COMCEL S.A.", "CO", "Cellular"],
    "AS3816": ["COLOMBIA TELECOMUNICACIONES S.A. ESP", "CO", "Broadband"],
    "AS10620": ["Telmex Colombia S.A.", "CO", "Cellular"],
    "AS27831": ["Colombia Movil", "CO", "Cellular"],
    "AS13489": ["EPM Telecomunicaciones S.A. E.S.P.", "CO", "Broadband"],
    "AS7418": ["TELEFONICA CHILE S.A.", "CL", "Cellular"],
    "AS27651": ["ENTEL CHILE S.A.", "CL", "Broadband"],
    "AS22047": ["VTR BANDA ANCHA S.A.", "CL", "Broadband"],
    "AS52341": ["WOM S.A.", "CL", "Broadband"],
    "AS27901": ["Pacifico Cable SPA.", "CL", "Broadband"],
    "AS27882": ["Telefonica Celular de Bolivia S.A.", "BO", "Cellular"],
    "AS6568": ["Entel S.A. - EntelNet", "BO", "Broadband"],
    "AS23201": ["Telecel S.A.", "PY", "Cellular"],
    "AS27895": ["Nucleo S.A.", "PY", "Cellular"],
    "AS8048": ["CANTV Servicios Venezuela", "VE", "Broadband"],
    "AS21826": ["Corporacion Telemic C.A.", "VE", "Cellular"],
    "AS7922": ["Comcast", "US", "Broadband"],
    "AS20115": ["Charter", "US", "Broadband"],
    "AS22773": ["Cox", "US", "Broadband"],
    "AS701": ["Verizon Business (Fios)", "US", "Broadband"],
    "AS7843": ["Charter (ex TWC)", "US", "Broadband"],
    "AS7018": ["AT&T", "US", "Cellular"],
    "AS6167": ["Verizon", "US", "Cellular"],
    "AS21928": ["T-Mobile", "US", "Cellular"],
    "AS6614": ["US Cellular", "US", "Cellular"],
    "AS22394": ["Verizon", "US", "Cellular"],
    "AS3215": ["Orange", "EU", "Europe"],
    "AS3269": ["Telecom Italia", "EU", "Europe"],
    "AS3320": ["Deutsche Telekom", "EU", "Europe"],
    "AS3352": ["Telefonica", "EU", "Europe"],
    "AS197207": ["Mobile Communication of Iran PLC", "IR", "Mobile"],
    "AS58224": ["TCI", "IR", "Mix"],
    "AS203214": ["Hulum Almustakbal", "IQ", "ISP"],
    "AS199739": ["Earthlink", "IR", "Mix"],
    "AS48832": ["ZAIN", "JO", "Mix"],
    "AS28885": ["Omantel", "OM", "Mix"],
    "AS43766": ["Zain", "SA", "Mix"],
    "AS39801": ["Al Jawal", "SA", "Mobile"],
    "AS35819": ["Etihad Etisalat", "SA", "Mix"],
    "AS25019": ["Saudinetstc", "SA", "ISP"],
    "AS29256": ["Int pdn ste", "SY", "Mix"],
    "AS34984": ["Tellcom", "TR", "ISP"],
    "AS20978": ["TT Mobil", "TR", "Mobile"],
    "AS16135": ["Turkcell", "TR", "Mobile"],
    "AS15897": ["Vodafone Turkiye", "TR", "Mix"],
    "AS9121": ["Turk Telekom", "TR", "Mix"],
    "AS8966": ["Etisalat", "AE", "Mix"],
    "AS5384": ["Emirates Telecommunications", "AE", "Mix"],
    "AS30873": ["Public Telecommunication", "YE", "Mix"]
}

# List of ASes recognized as "cloud". They match 2 selective criteria:
#
# The ratio between the number of queries served from their largest "query AS"
# and the total number for that "query AS" is lower than 0.4
# The number of country codes listed in those query Ases is at least 2,
# and the number of queries served for that "query AS" overall is small
# compared to the number of queries routed from other ASes. The list:
#
# discuss: yandex has DNS services similar to Google, CLoudflare
# 
CloudAS = {
    "AS396982": "GOOGLE-CLOUD-PLATFORM",
    "AS20940": "AKAMAI-ASN1",
    "AS36692": "CISCO-UMBRELLA",
    "AS36236": "NETACTUATE",
    "AS54825": "PACKET",
    "AS16509": "AMAZON-02",
    "AS18734": "Operbes, S.A. de C.V.",
    "AS13238": "YANDEX",
    "AS208398": "TELETECH",
    "AS30844": "LIQUID-AS",
    "AS42": "WOODYNET-1",
    "AS49544": "i3Dnet",
    "AS60068": "CDN77",
    "AS38091": "HELLONET-AS-KR-KR"
}

# List of ASes that are sending their DNS traffic to a resolver
# in the same company
RsvAS = {
    "AS10620": "AS14080",
    "AS11664": "AS19037",
    "AS12091": "AS16637",
    "AS12716": "AS8717",
    "AS13285": "AS9105",
    "AS16135": "AS34984",
    "AS17421": "AS3462",
    "AS17552": "AS7470",
    "AS17858": "AS3786",
    "AS18004": "AS133798",
    "AS18881": "AS10429",
    "AS199739": "AS50710",
    "AS206026": "AS21299",
    "AS20978": "AS9121",
    "AS24158": "AS9924",
    "AS24203": "AS17885",
    "AS24378": "AS9587",
    "AS24560": "AS9498",
    "AS25472": "AS1241",
    "AS26599": "AS10429",
    "AS27831": "AS13489",
    "AS36903": "AS6713",
    "AS36935": "AS24835",
    "AS37069": "AS24863",
    "AS37457": "AS5713",
    "AS39891": "AS25019",
    "AS45609": "AS9498",
    "AS51207": "AS12322",
    "AS56167": "AS17557",
    "AS59257": "AS138423",
    "AS6167": "AS22394",
    "AS8814": "AS34170",
    "AS9506": "AS3758"
}

GroupAS = {
    "AS9498": "AS24560",
    "AS45609": "AS24560",
    "AS6167": "AS22394",
    "AS24203": "AS17885",
    "AS26599": "AS10429",
    "AS18881": "AS10429",
    "AS39891": "AS25019",
    "AS7470": "AS17552",
    "AS3786": "AS17858",
    "AS6713": "AS36903",
    "AS22884": "AS17072",
    "AS14080": "AS10620",
    "AS21299": "AS206026",
    "AS59257": "AS138423",
    "AS36935": "AS24835",
    "AS9121": "AS20978",
    "AS51207": "AS12322",
    "AS34984": "AS16135",
    "AS9808": "AS56040",
    "AS50710": "AS199739",
    "AS9105": "AS13285",
    "AS58543": "AS137702",
    "AS4134": "AS137702",
    "AS19037": "AS11664",
    "AS3462": "AS17421",
    "AS18004": "AS133798",
    "AS8737": "AS1136",
    "AS9587": "AS24378",
    "AS9924": "AS24158",
    "AS4230": "AS22085",
    "AS8717": "AS12716",
    "AS4761": "AS45727",
    "AS37069": "AS24863",
    "AS56167": "AS17557",
    "AS5713": "AS37457",
    "AS16637": "AS12091",
    "AS27986": "AS27651",
    "AS22927": "AS11315",
    "AS27831": "AS13489",
    "AS3329": "AS12361",
    "AS9506": "AS3758",
    "AS55410": "AS38266",
    "AS8814": "AS34170",
    "AS25472": "AS1241",
    "AS48503": "AS29555",
    "AS9824": "AS9617",
    "AS4835": "AS137702",
    "AS17633": "AS137702",
    "AS7545": "AS4739",
    "AS43612": "AS43494",
    "AS28481": "AS13999",
    "AS7018": "AS6389",
    "AS27672": "AS13999",
    "AS5650": "AS3593",
    "AS4809": "AS137702",
    "AS4837": "AS24139",
}

# List of ASes with known names, carefully acquired through Whois
ref_AS_names = {
"AS55836": "RELIANCEJIO-IN",
"AS45609": "BHARTI-MOBILITY-AS-AP",
"AS24560": "AIRTELBROADBAND-AS-AP",
"AS38266": "VIL-AS-AP",
"AS45271": "AS45271",
"AS9829": "BSNL-NIB",
"AS24309": "CABLELITE-AS-AP",
"AS133661": "NETPLUS-AS",
"AS133982": "EXCITEL-AS-IN",
"AS45916": "GTPL-AS-AP",
"AS7922": "COMCAST-7922",
"AS7018": "ATT-INTERNET4",
"AS6167": "CELLCO-PART",
"AS21928": "T-MOBILE-AS21928",
"AS20115": "CHARTER-20115",
"AS701": "UUNET",
"AS22773": "ASN-CXA-ALL-CCI-22773-RDC",
"AS10796": "TWC-10796-MIDWEST",
"AS20001": "TWC-20001-PACWEST",
"AS5650": "FRONTIER-FRTR",
"AS7713": "telkomnet-as-ap",
"AS23693": "TELKOMSEL-ASN-ID",
"AS4761": "INDOSAT-INP-AP",
"AS24203": "NAPXLNET-AS-ID",
"AS18004": "WIRELESSNET-ID",
"AS4134": "CHINANET-BACKBONE",
"AS4837": "CHINA169-Backbone",
"AS9808": "CHINAMOBILE-CN",
"AS4812": "CHINANET-SH-AP",
"AS56046": "CMNET-Jiangsu-AP",
"AS4808": "CHINA169-BJ",
"AS56048": "CMNET-BEIJING-AP",
"AS24400": "CMNET-V4shanghai-AS-AP",
"AS24444": "CMNET-V4shandong-AS-AP",
"AS24445": "CMNET-V4henan-AS-AP",
"AS8151": "Uninet S.A. de C.V.",
"AS17072": "TOTAL PLAY TELECOMUNICACIONES SA DE CV",
"AS13999": "Mega Cable  S.A. de C.V.",
"AS28403": "RadioMovil Dipsa  S.A. de C.V.",
"AS28548": "Cablevision  S.A. de C.V.",
"AS8452": "TE-AS",
"AS36935": "Vodafone Data",
"AS36992": "ETISALAT MISR",
"AS24835": "Vodafone Data",
"AS37069": "The Egyptian Company for Mobile Services (Mobinil)",
"AS9299": "IPG-AS-AP",
"AS17639": "CONVERGE-AS",
"AS132199": "GLOBE-MOBILE-5TH-GEN-AS",
"AS10139": "SMARTBRO-PH-AP",
"AS4775": "GLOBE-TELECOM-AS",
"AS17676": "GIGAINFRA",
"AS2516": "KDDI",
"AS4713": "OCN",
"AS9605": "docomo",
"AS9824": "JTCL-JP-AS",
"AS3215": "Orange",
"AS15557": "LDCOMNET",
"AS5410": "BOUYGTEL-ISP",
"AS12322": "PROXAD",
"AS51207": "FREEM",
"AS3320": "DTAG",
"AS3209": "VODANET",
"AS6805": "TDDE-ASN1",
"AS8881": "VERSATEL",
"AS24940": "HETZNER-AS",
"AS29465": "MTN NIGERIA Communication limited",
"AS36873": "Airtel Networks Limited",
"AS328309": "Globacom Limited",
"AS2856": "BT-UK-AS",
"AS5607": "BSKYB-BROADBAND-AS",
"AS5089": "NTL",
"AS13285": "OPALTELECOM-AS",
"AS5378": "unspecified",
"AS7552": "VIETEL-AS-AP",
"AS45899": "VNPT-AS-VN",
"AS18403": "FPT-AS-AP",
"AS131429": "MOBIFONE-AS-VN",
"AS9121": "TTNet",
"AS34984": "TELLCOM-AS",
"AS16135": "TURKCELL-AS",
"AS15897": "VodafoneTurkey",
"AS20978": "TT_Mobil",
"AS1221": "ASN-TELSTRA",
"AS4804": "MPX-AS",
"AS7545": "TPG-INTERNET-AP",
"AS9443": "VOCUS-RETAIL-AU",
"AS4764": "WIDEBAND-AS-AP",
"AS4766": "KIXS-AS-KR-KR",
"AS9318": "SKB-AS-KR",
"AS17858": "POWERVIS-AS-KR-KR",
"AS9644": "SKTELECOM-NET-AS-KR",
"AS17853": "LGTELECOM-AS-KR-KR",
"AS28573": "Claro NXT Telecomunicacoes Ltda",
"AS26599": "TELEFONICA BRASIL S.A",
"AS18881": "TELEFONICA BRASIL S.A",
"AS22085": "Claro S/A",
"AS26615": "TIM S/A",
"AS30986": "Scancom Limited",
"AS29614": "Ghana Telecommunications Company Limited",
"AS577": "BACOM",
"AS852": "ASN852",
"AS812": "ROGERS-COMMUNICATIONS",
"AS6327": "SHAW",
"AS5769": "VIDEOTRON",
"AS1267": "ASN-WINDTRE",
"AS30722": "VODAFONE-IT-ASN",
"AS3269": "ASN-IBSNAZ",
"AS29447": "TIF-AS",
"AS12874": "FASTWEB",
"AS4609": "CTM-MO",
"AS39891": "ALJAWWALSTC-AS",
"AS25019": "SAUDINETSTC-AS",
"AS35819": "Mobily-AS",
"AS43766": "MTC-KSA-AS",
"AS8708": "RCS-RDS",
"AS12302": "Vodafone_Ro",
"AS8953": "ASN-ORANGE-ROMANIA",
"AS4788": "TTSSB-MY",
"AS9534": "MAXIS-AS1-AP",
"AS10030": "CELCOMNET-AP",
"AS4818": "DIGIIX-AP",
"AS38466": "UMOBILE-AS-AP",
"AS197207": "MCCI-AS",
"AS58224": "TCI",
"AS203214": "HulumTele",
"AS199739": "Earthlink-DMCC-IQ",
"AS206206": "KNET",
"AS21277": "Newroz-Telecom-ASN",
"AS59588": "ZAINAS-IQ",
"AS3352": "Telefonica_de_Espana",
"AS12479": "UNI2-AS",
"AS15704": "AS15704",
"AS12430": "VODAFONE_ES",
"AS57269": "DIGISPAINTELECOM",
"AS7303": "Telecom Argentina S.A.",
"AS22927": "Telefonica de Argentina",
"AS11664": "Techtel LMDS Comunicaciones Interactivas S.A.",
"AS27747": "Telecentro S.A.",
"AS131445": "AIS3G-2100-AS-AP",
"AS17552": "TRUEONLINE-AS-AP",
"AS133481": "AIS-Fibre-AS-AP",
"AS45758": "TTBP-AS-AP",
"AS24378": "ENGTAC-AS-TH-AP",
"AS5617": "TPNET",
"AS39603": "P4NET",
"AS8374": "PLUSNET",
"AS12912": "TMPL",
"AS6830": "LibertyGlobal",
"AS24757": "Ethio Telecom",
"AS328988": "SAFARICOM TELECOMMUNICATIONS ETHIOPIA PLC",
"AS8193": "BRM-AS",
"AS49273": "COSCOM-AS",
"AS201767": "UZMOBILE-AS",
"AS64466": "UMS-AS",
"AS41202": "UNITEL",
"AS17557": "PKTELECOM-AS-PK",
"AS59257": "CMPAKLIMITED-AS-AP",
"AS9541": "CYBERNET-AP",
"AS45669": "Mobilink-AS-PK",
"AS56167": "PTML-PK",
"AS8346": "SONATEL",
"AS15895": "KSNET-AS",
"AS21497": "UMC-AS",
"AS34058": "LIFECELL-AS",
"AS36903": "Office National des Postes et Telecommunications ONPT (Maroc Telecom) / IAM",
"AS36925": "MEDITELECOM",
"AS9198": "KAZTELECOM-AS",
"AS48503": "TELE2-KZ",
"AS206026": "ipnet_kar-tel",
"AS21299": "KAR-TEL-AS",
"AS29355": "KCELL-AS",
"AS8400": "TELEKOM-AS",
"AS31042": "SERBIA-BROADBAND-AS",
"AS15958": "CETIN_doo_AS",
"AS39832": "NO-OPERA",
"AS29695": "Altibox_AS",
"AS2119": "TELENOR-NEXTEL",
"AS24389": "GRAMEENPHONE-AS-AP",
"AS24432": "AXIATA-ROBI-AS-AP",
"AS45245": "banglalink-AS",
"AS6697": "BELPAK-AS",
"AS25106": "MTSBY-AS",
"AS42772": "A1-BY-AS",
"AS33915": "TNF-AS",
"AS1136": "KPN",
"AS50266": "Odido",
"AS29571": "Orange CÃ´te d'Ivoire",
"AS36974": "MTN COTE D'IVOIRE S.A",
"AS37190": "Atlantique Telecom (Cote d'Ivoire)",
"AS2860": "NOS_COMUNICACOES",
"AS3243": "MEO-RESIDENCIAL",
"AS12353": "VODAFONE-PT",
"AS3301": "TELIANET-SWEDEN",
"AS1257": "SWIPNET",
"AS2119": "TELENOR-NEXTEL",
"AS6799": "OTENET-GR",
"AS3329": "HOL-GR",
"AS25472": "WIND-AS",
"AS33771": "Safaricom Limited",
"AS36926": "Airtel Networks Kenya Limited",
"AS5432": "PROXIMUS-ISP-AS",
"AS6848": "TELENET-AS",
"AS47377": "Orange_Belgium_SA",
"AS7418": "TELEFONICA CHILE S.A.",
"AS27651": "ENTEL CHILE S.A.",
"AS22047": "VTR BANDA ANCHA S.A.",
"AS52341": "Centennial Cayman Corp Chile S.A",
"AS27901": "Pacifico Cable SPA.",
"AS3462": "HINET",
"AS17421": "EMOME-NET",
"AS9674": "FET-TW",
"AS24158": "taiwanmobile-as",
"AS8866": "VIVACOM-AS",
"AS29244": "TelenorBG-AS",
"AS12716": "A1BG_MB",
"AS6147": "Telefonica del Peru S.A.A.",
"AS12252": "America Movil Peru S.A.C.",
"AS262210": "VIETTEL PERU S.A.C.",
"AS21575": "ENTEL PERU S.A.",
"AS26611": "COMCEL S.A.",
"AS3816": "COLOMBIA TELECOMUNICACIONES S.A. ESP",
"AS10620": "Telmex Colombia S.A.",
"AS13489": "EPM Telecomunicaciones S.A. E.S.P.",
"AS27831": "Colombia Movil",
"AS37020": "CELTEL DRC",
"AS37447": "ORANGE RDC",
"AS37453": "Vodacom Congo",
"AS3292": "TDC",
"AS12400": "PARTNER-AS",
"AS6810": "BEZEK",
"AS1680": "NV-ASN",
"AS12849": "HOTNET-IL",
"AS16116": "UNSPECIFIED",
"AS8966": "Etisalat-AS",
"AS5384": "EMIRATES-INTERNET",
"AS15802": "DU-AS1",
"AS36947": "Telecom Algeria",
"AS29256": "INT-PDN-STE-AS",
"AS37457": "Telkom SA Ltd.",
"AS29975": "Vodacom",
"AS12091": "MTN SA",
"AS37105": "rain admin role",
"AS20011": "Dimension Data",
"AS18001": "DIALOG-AS",
"AS20294": "MTN Uganda",
"AS37075": "Airtel Uganda Limited",
"AS30873": "PTC-YemenNet",
"AS12975": "PALTEL-AS",
"AS5610": "O2-CZECH-REPUBLIC",
"AS13036": "TMOBILE-CZ",
"AS16019": "VODAFONE-CZ-AS",
"AS17882": "Univision-AS-AP",
"AS16010": "MagticomAS",
"AS35805": "SILKNET-AS",
"AS17501": "WLINK-NEPAL-AS-AP",
"AS37705": "TOPNET",
"AS37693": "OOREDOO TUNISIE SA",
"AS37492": "Orange Tunisie",
"AS8412": "TMA",
"AS8447": "A1TELEKOM-AT",
"AS25255": "H3G-Austria-AS",
"AS30985": "Orange Mali SA",
"AS21271": "Society of Mali's Telecommunications (SOTELMA)",
"AS5391": "T-HT",
"AS48832": "Zain-Jo",
"AS8376": "UNSPECIFIED",
"AS9038": "BAT-AS9038",
"AS37461": "ORANGE GUINEE",
"AS37119": "UNITEL SA",
"AS8048": "CANTV Servicios  Venezuela",
"AS21826": "Corporacion Telemic C.A.",
"AS6306": "TELEFONICA VENEZOLANA  C.A.",
"AS264628": "The Houses Television C.A. (ConexTELECOM)",
"AS6057": "Administracion Nacional de Telecomunicaciones",
"AS36912": "Orange Cameroun SA",
"AS4760": "HKTIMS-AP",
"AS37342": "Movitel, SA",
"AS6568": "Entel S.A. - EntelNet",
"AS27882": "Telefonica Celular de Bolivia S.A.",
"AS5483": "MAGYAR-TELEKOM-MAIN-AS",
"AS37577": "Orange Burkina Faso",
"AS4771": "SPARKNZ",
"AS9790": "TWO-DEGREES-AS-AP",
"AS9500": "ONENZ-TRANSIT-AS",
"AS38623": "VIETTELCAMBODIA-AS-AP",
"AS37287": "Zain Zambia PLC",
"AS719": "ELISA-AS",
"AS16086": "DNA",
"AS1759": "TSF-IP-Core",
"AS3303": "SWISSCOM",
"AS8764": "Telia-Lietuva",
"AS36908": "Vodacom Tanzania Ltd",
"AS37035": "MIC TANZANIA LTD",
"AS37133": "Airtel Tanzania",
"AS6821": "MT-AS-OWN",
"AS43612": "A1MK-AS43612",
"AS27947": "Telconet S.A",
"AS9146": "BIHNET",
"AS25144": "TELEKOM-SRPSKE-AS",
"AS28885": "OMANTEL-NAP-AS",
"AS21246": "IPKO-AS",
"AS47237": "NURTELECOM-AS-RIPE",
"AS8814": "AZT-AS",
"AS28787": "BAKINTER-AS",
"AS6855": "SK-TELEKOM",
"AS30689": "FLOW-NET",
"AS23201": "Telecel S.A.",
"AS42003": "OGERONET",
"AS44395": "ORG-UL31-RIPE",
"AS5466": "EIRCOM",
"AS5607": "BSKYB-BROADBAND-AS",
"AS15502": "Vodafone-Ireland-ASN",
"AS14638": "LCPRL",
"AS37371": "Hormuud Telecom Somalia INC",
"AS9506": "SINGTEL-FIBRE",
"AS6400": "Compania Dominicana de Telefonos S. A.",
"AS29357": "WATANIYATELECOM-AS",
"AS42961": "GPRS-AS",
"AS328228": "SOCIETE BENINOISE D'INFRASTRUCTURES NUMERIQUES",
}

def top_as_list():
    return list(TopAS.keys())

def as_group(q_as):
    if q_as in GroupAS:
        q_group = GroupAS[q_as]
    else:
        q_group = q_as
    return q_group

class known_AS_names:
    def __init__(self):
        self.as_names = dict()
        for asn in ref_AS_names:
            self.as_names[asn] = ref_AS_names[asn]
        for asn in TopAS:
            as_entry = TopAS[asn]
            self.as_names[asn] = as_entry[0]
        print("Started with: " + str(len(self.as_names)) + " names.")

    def process_row(self, x, headers=['asn', 'as_name', 'has_name'] ):
        if (headers[0] in x) and (headers[1] in x) and (headers[2] in x) and (x[headers[2]] == True):
            if not x[headers[0]] in self.as_names:
                self.as_names[x[headers[0]]] = x[headers[1]]

    def load_top_as(self, file_name):
        print("Loading: " + file_name)
        df = pd.read_csv(file_name)
        print("Loaded: " + file_name)
        df.apply(lambda x: self.process_row(x), axis=1)
        print("Loaded: " + str(len(self.as_names)) + " names.")

    def get_name(self, asn, cc, as_name):
        success = False
        if asn in self.as_names:
            success = True
            as_name = self.as_names[asn]
        else:
            if cc in country.cc_to_region:
                region = country.cc_to_region[cc]
            else:
                region = 'EUR'
            success, as_name = rdap_names.get_as_name_by_region(region, asn, as_name)
            if success:
                self.as_names[asn] = as_name
        return success, as_name

